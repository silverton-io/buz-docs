<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">The Contract-Powered Data Platform | Buz</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://buz.dev/blog/the-contract-powered-data-platform"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" name="Buz" description="Streaming, simplified." content="data, processing, streaming, quality, contracts"><meta data-rh="true" property="og:image" content="https://buz.dev/img/buzz.png"><meta data-rh="true" property="twitter:image" content="https://buz.dev/img/buzz.png"><meta data-rh="true" property="og:title" content="The Contract-Powered Data Platform | Buz"><meta data-rh="true" name="description" content="The contract-powered data platform is a step towards improving data quality, reducing organizational friction, and automating the toil data teams face. Here&#x27;s what it looks like and how it works."><meta data-rh="true" property="og:description" content="The contract-powered data platform is a step towards improving data quality, reducing organizational friction, and automating the toil data teams face. Here&#x27;s what it looks like and how it works."><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2022-10-07T16:38:54.000Z"><meta data-rh="true" property="article:author" content="https://github.com/jakthom"><meta data-rh="true" property="article:tag" content="data platform,schemas,interfaces,data contracts or whatever"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://buz.dev/blog/the-contract-powered-data-platform"><link data-rh="true" rel="alternate" href="https://buz.dev/blog/the-contract-powered-data-platform" hreflang="en"><link data-rh="true" rel="alternate" href="https://buz.dev/blog/the-contract-powered-data-platform" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Buz RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Buz Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-E9VYMMT9R3"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-E9VYMMT9R3",{})</script>


<script>!function(e,o,a,s,n,t,p){e[n]||(e.GlobalSnowplowNamespace=e.GlobalSnowplowNamespace||[],e.GlobalSnowplowNamespace.push(n),e[n]=function(){(e[n].q=e[n].q||[]).push(arguments)},e[n].q=e[n].q||[],t=o.createElement(a),p=o.getElementsByTagName(a)[0],t.async=1,t.src="https://cdn.jsdelivr.net/npm/@snowplow/javascript-tracker@3.4.0/dist/sp.js",p.parentNode.insertBefore(t,p))}(window,document,"script",0,"snowplow"),snowplow("newTracker","sp","docstream.buz.dev",{appId:"buz-docs",platform:"web",withCredentials:!1,cookieSameSite:"Lax",discoverRootDomain:!0})</script><link rel="stylesheet" href="/assets/css/styles.0cdbffef.css">
<link rel="preload" href="/assets/js/runtime~main.60654a09.js" as="script">
<link rel="preload" href="/assets/js/main.6b317ddd.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="theme.common.skipToMainContent"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/bee2.svg" alt="Buz" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/bee2.svg" alt="Buz" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Buz</b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/">Docs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><a href="https://github.com/silverton-io/buz" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/blog/the-contract-powered-data-platform">The Contract-Powered Data Platform</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/make-it-easy">Make It Easy</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="title_f1Hy" itemprop="headline">The Contract-Powered Data Platform</h1><div class="container_mt6G margin-vert--md"><time datetime="2022-10-07T16:38:54.000Z" itemprop="datePublished">October 7, 2022</time> ¬∑ <!-- -->13 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/jakthom" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/jakthom.png" alt="Jake"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/jakthom" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Jake</span></a></div></div></div></div></div></header><div id="post-content" class="markdown" itemprop="articleBody"><p>Between <a href="https://6river.com/?utm_source=buz.dev&amp;utm_content=hiitsme" target="_blank" rel="noopener noreferrer">6 River Systems</a> and <a href="https://www.cargurus.com/" target="_blank" rel="noopener noreferrer">CarGurus</a>, a very significant amount of my time over the past five years has been dedicated to data platform automation, reducing cross-team friction, and improving data quality.</p><p>Schemas have played a critical role in the process; this post outlines <strong>the why and the how</strong>. But before diving straight<!-- --> into the role of schemas (er... contracts) let&#x27;s talk data platforms.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="components-of-a-good-data-platform">Components of a Good Data Platform<a class="hash-link" href="#components-of-a-good-data-platform" title="Direct link to heading">‚Äã</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="instrumentation-and-integration">Instrumentation and Integration<a class="hash-link" href="#instrumentation-and-integration" title="Direct link to heading">‚Äã</a></h3><p>This one goes without saying. If data is not being emitted from source systems you won&#x27;t have any data to play with.</p><p>If you don&#x27;t have any data the rest of this post will not provide value. You also won&#x27;t be able to complain about the price of Snowflake and might feel left out. </p><p>Instrumentation is pretty important. It&#x27;s also a pretty huge PITA to wrangle, which is why <a href="https://segment.com/academy/collecting-data/how-to-create-a-tracking-plan/" target="_blank" rel="noopener noreferrer">tracking</a> <a href="https://amplitude.com/blog/create-tracking-plan" target="_blank" rel="noopener noreferrer">plans</a> <a href="https://www.avo.app/blog/what-is-a-tracking-plan-and-why-do-you-need-one" target="_blank" rel="noopener noreferrer">became</a> <a href="https://www.indicative.com/resource/data-tracking-plan/" target="_blank" rel="noopener noreferrer">a</a> <a href="https://www.trackingplan.com/" target="_blank" rel="noopener noreferrer">thing</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-pipeline">The pipeline<a class="hash-link" href="#the-pipeline" title="Direct link to heading">‚Äã</a></h3><p>Pipelines are either <code>batch</code> or <code>streaming</code>. There&#x27;s a holy war between the two religions, but similar concepts apply to both.</p><p>Pipelines collect data and put it somewhere. Sometimes they mutate said data. That&#x27;s really it.</p><p>The <em>best</em> pipelines:</p><ul><li>Move data reliably.</li><li>Annotate payloads with metadata such as provenance, <code>collected_at</code> timestamps, fingerprints, etc.</li><li>Generate stats to provide the operator with feedback.</li><li>Validate and bifurcate payloads, if you&#x27;re lucky.</li><li>Know about and act on payload sensitivities - obfuscate, hash, tokenize, redact, redirect, etc.</li><li>Minimize moving pieces.</li><li>Don&#x27;t spend all the CEO&#x27;s üí∏üí∏üí∏ so they can afford that house in the Bahamas.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="storage-and-access">Storage and access<a class="hash-link" href="#storage-and-access" title="Direct link to heading">‚Äã</a></h3><p>Data has to be stored somewhere- preferably somewhere accessible.</p><p>Storage/access systems range from a wee little Postgres database, to Snowflake, to a data lake filled with Parquet fish and the <del>Loch Ness</del> Trino monster.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="data-discovery">Data Discovery<a class="hash-link" href="#data-discovery" title="Direct link to heading">‚Äã</a></h3><p>As things scale, pipelines/databases/data models often turn into something the James Webb <em>and</em> dbt can&#x27;t stitch back together.</p><p>Data discoverability is super important when organizations are fragmented, or when you&#x27;re new to the company, or when you forget stuff as I often do.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="observability-monitoring-and-alerting">Observability, Monitoring, and Alerting<a class="hash-link" href="#observability-monitoring-and-alerting" title="Direct link to heading">‚Äã</a></h3><p>Last, definitely not least, and unfortunately-rare... tools that tell the operator if things are broken.</p><p>These could be devops-y tools like Prometheus/Alertmanager/Grafana, pay-to-play tools like data quality/reliability platforms, or something dead-simple like load metadata tables and freshness checks.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="design-goals-of-a-good-data-platform">Design Goals of a Good Data Platform<a class="hash-link" href="#design-goals-of-a-good-data-platform" title="Direct link to heading">‚Äã</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="comply-with-rules">Comply with rules<a class="hash-link" href="#comply-with-rules" title="Direct link to heading">‚Äã</a></h3><p>While maybe not the case within the US (for us Non-Californians), data regulation and compliance is kind of a big deal. If you don&#x27;t comply, <a href="https://www.wired.com/story/google-analytics-europe-austria-privacy-shield/" target="_blank" rel="noopener noreferrer">good</a> <a href="https://edpb.europa.eu/news/national-news/2022/italian-sa-bans-use-google-analytics-no-adequate-safeguards-data-transfers_en" target="_blank" rel="noopener noreferrer">luck</a>.</p><p>Compliance is becoming less of a <code>goal</code> and more of a <code>requirement</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="minimize-bad-data">Minimize bad data<a class="hash-link" href="#minimize-bad-data" title="Direct link to heading">‚Äã</a></h3><p>Bad data is expensive. It&#x27;s expensive to move, it&#x27;s expensive to store, it&#x27;s expensive to keep track of, and it&#x27;s expensive to work around. Not knowing data is bad is even more expensive.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="maximize-knowledge-of-what-the-system-is-doing">Maximize knowledge of what the system is doing<a class="hash-link" href="#maximize-knowledge-of-what-the-system-is-doing" title="Direct link to heading">‚Äã</a></h3><p>Good things come from a knowledge of what a system is doing and when it is doing it.</p><p>Only after measurement can you optimize cost.</p><p>Only after timing can you make things faster.</p><p>And only after seeing a system end-to-end can you cut out unnecessary intermediaries.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="minimize-friction-for-all-parties-involved">Minimize friction for all parties involved<a class="hash-link" href="#minimize-friction-for-all-parties-involved" title="Direct link to heading">‚Äã</a></h3><p>Data platforms should be a good experience for everyone. Which includes <strong>many</strong> more parties than just analytics engineers or analysts.</p><p>Parties who are critical to success include:</p><ul><li>The frontend engineers, who work with Javascript/Typescript and any number of frameworks </li><li>The backend engineers, who work with Python, Node, Java, Go, C++</li><li>The native/app engineers, who work with something like Swift, Flutter, React Native</li><li>The devops people, who like when they can write less Terraform.</li><li>The SRE people, who like when they can see what&#x27;s going on without asking you. Because you&#x27;ll probably be asleep when they try.</li><li>The data engineers, who are usually on the hook when data goes bad.</li><li>The analytics engineers, who like when <code>user_id</code> means <code>user_id</code>.</li><li>The analysts, who like when they can push value back to product engineers.</li><li>The financefolk, who will come after you when costs exponentially increase.</li><li>The businessfolk, who will also come after you when costs exponentially increase.</li></ul><p>While data mandates and a new breed of data-oriented law might sound lovely (or not), these mechanisms only benefit a couple of the above parties. Mandates don&#x27;t work. Telling other people to have more responsibility, so you can have less, also doesn&#x27;t work.</p><p>Want to get buy-in? Minimize friction. Want to increase adoption? Automate others&#x27; toil. Want sustainable systems? Reduce cognitive load.</p><p>Which brings us back to schematizing stuff.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-contract-powered-platform">The Contract-Powered Platform<a class="hash-link" href="#the-contract-powered-platform" title="Direct link to heading">‚Äã</a></h2><p>I&#x27;m going to go out on a limb and just say it -&gt; schemas are the nucleus of sustainable data platforms.</p><p>Schematizing data upfront is often initially discarded and seen as <a href="https://twitter.com/Mike_Kaminsky/status/1573430588958445569" target="_blank" rel="noopener noreferrer">unnecessary overhead</a> or a productivity drain. The idea is nixed in favor of the eventual chaos arbitrary json creates. But who cares about our hypothetical future selves - it&#x27;s our current selves that matter. Let&#x27;s dig in for the sake of science.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="schemas-empower-the-producer---consumer-relationship">Schemas empower the &quot;producer&quot; &lt;-&gt; &quot;consumer&quot; relationship<a class="hash-link" href="#schemas-empower-the-producer---consumer-relationship" title="Direct link to heading">‚Äã</a></h3><p>Let&#x27;s think about the two ends of data systems for a second.</p><p>Engineers exist at the source, product analysts typically exist at the &quot;destination&quot;, and a black box lies between:</p><p><img loading="lazy" alt="mystery data thing" src="/assets/images/mystery_data_thing-7cf9e8be611dbfd4fe512fe661919539.png" width="2446" height="1126" class="img_ev3q"></p><p>But when the mystery data thing is removed, the <code>engineer</code> &lt;-&gt; <code>analyst</code> dynamic actually looks more like this:</p><p><img loading="lazy" alt="engineers and analysts" src="/assets/images/engs_and_analysts-c5f9ea148a629098798d55194dd478f9.png" width="2500" height="1218" class="img_ev3q"></p><p>This working dynamic is pretty terrible for productivity. The two parties communicate, sometimes. There&#x27;s a ton of friction and neither party is to blame. Data engineers and managers are asked to join the conversation, and implicit &quot;contracts&quot; are established in a Google doc that everyone will lose track of.</p><p>(Human-readable) schemas turn this dynamic into something that looks more like the following:</p><p><img loading="lazy" alt="declarative thing" src="/assets/images/declarativeThing-bcb8716354dd657813ffbe9f0cf061e1.png" width="2550" height="948" class="img_ev3q"></p><p>Both parties contribute to a schema with consistent verbiage, which is then leveraged to generate the equivalent data structure in their language of choice.</p><p>Today&#x27;s data workflows look <strong>very similar</strong> to how software engineering looked prior to <a href="https://github.blog/2008-02-23-oh-yeah-there-s-pull-requests-now/" target="_blank" rel="noopener noreferrer">Github announcing Pull Requests in 2008</a>. They work, but aren&#x27;t ideal.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="schemas-are-data-discovery">Schemas are data discovery<a class="hash-link" href="#schemas-are-data-discovery" title="Direct link to heading">‚Äã</a></h3><p>In LinkedIn&#x27;s <a href="https://engineering.linkedin.com/blog/2020/datahub-popular-metadata-architectures-explained" target="_blank" rel="noopener noreferrer">popular metadata architectures explained</a>, pull-based metadata extraction is outlined as &quot;an ok start&quot;. Push-based metadata is &quot;ideal&quot;.</p><p>Schematizing data upfront means data discovery and documentation writes itself. Data assets are discoverable as soon as schemas are deployed - before the data actually starts flowing.</p><p>Schematization mechanisms like JSON Schema also get <a href="https://json-schema.org/specification.html#meta-schemas" target="_blank" rel="noopener noreferrer">pretty meta</a>, so it&#x27;s easy to add annotation such as:</p><ul><li>&quot;These properties contain PII&quot;</li><li>&quot;These properties should be tokenized&quot;</li><li>&quot;X person on Y team owns this schema&quot;</li><li>&quot;This is version <code>1.4</code>. Here&#x27;s how this data has evolved from <code>1.0</code>.&quot;</li></ul><p>This class of metadata is a CISO&#x27;s <em>dream</em>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="schemas-power-data-validation-in-transit">Schemas power data validation in transit<a class="hash-link" href="#schemas-power-data-validation-in-transit" title="Direct link to heading">‚Äã</a></h3><p>Comparing a payload to &quot;what it was supposed to be&quot; and annotating it with a simple üëçüëé is extremely valuable. Schemas are the &quot;what it was supposed to be&quot;.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="schemas-help-stop-bad-instrumentation-from-being-implemented-in-the-first-place">Schemas help stop bad instrumentation from being implemented in the first place<a class="hash-link" href="#schemas-help-stop-bad-instrumentation-from-being-implemented-in-the-first-place" title="Direct link to heading">‚Äã</a></h3><p>Another +1 (for engineers) is the fact schemas help prevent bad tracking from getting deployed in the first place.</p><p>Language-specific data structures can be generated from schemas. Which means intellisense or the compiler complains during development if required props are missing, or if one is a <code>string</code> and should be a <code>bool</code>. And then the code blows up again at compile time if the bug is still there.</p><p>Nobody likes being the person who causes the release train to halt. Or being the person who caused the rollback because a prop was missing. <strong>Especially when it&#x27;s &quot;just for analytics&quot;.</strong></p><p>Merging to <code>main</code> only after instrumentation is üëçüëç is the ideal workflow. It saves rollbacks. It avoids the human friction of going to the data team... <em>again</em>, to have them explain their mandated &quot;contract&quot;.</p><p>And it&#x27;s just good engineering.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="schemas-improve-code-quality">Schemas improve code quality<a class="hash-link" href="#schemas-improve-code-quality" title="Direct link to heading">‚Äã</a></h3><p>This might be a stretch. Or maybe not.</p><p>Have you tried forcing an engineer who loves Typescript to use <code>Any</code>, while simultaneously mandating payloads have <code>propA</code>, <code>propB</code>, and <code>propC</code>. And <code>propC</code> must be a <code>bool</code>?</p><p>Or tried forcing a golang-oriented engineer to use a <code>map[string]interface{}</code>, but told them the payload must have specific keys?</p><p>I have. And it was pretty silly. And a couple quick Google searches highlight <a href="https://medium.com/@warkiringoda/typescript-best-practices-2021-a58aee199661" target="_blank" rel="noopener noreferrer">Don&#x27;t Use Any</a>. <a href="https://bitfieldconsulting.com/golang/commandments" target="_blank" rel="noopener noreferrer">Use <code>map[string]interface{}</code> sparingly</a>. Lint rules will not-so-nicely tell you to pound sand.</p><p>Schemas are centralized verbiage from which to generate language-specific data structures. Tools like <a href="https://github.com/quicktype/quicktype" target="_blank" rel="noopener noreferrer">Quicktype</a>, <a href="https://github.com/sinclairzx81/typebox" target="_blank" rel="noopener noreferrer">Typebox</a>, and <a href="https://www.npmjs.com/package/json-schema-to-typescript" target="_blank" rel="noopener noreferrer">jsonschema-to-typescript</a> make this a reality. The same can be said about <a href="https://www.rfc-editor.org/rfc/rfc8927" target="_blank" rel="noopener noreferrer">JTD</a> and <a href="https://developers.google.com/protocol-buffers" target="_blank" rel="noopener noreferrer">Protocol Buffers</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="schemas-power-automation">Schemas power automation<a class="hash-link" href="#schemas-power-automation" title="Direct link to heading">‚Äã</a></h3><p>Schemas make data engineering quality of life significantly better. Destination tables can be automatically created and migrated as schemas evolve. Kafka topics and Pub/Sub streams can be automatically provisioned using the schema namespace. A single stream can be fanned out to a <a href="https://docs.aws.amazon.com/firehose/latest/dev/dynamic-partitioning.html" target="_blank" rel="noopener noreferrer">dynamically-partitioned data lake</a>. And a whole lot more.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="schemas-as-observability">Schemas as observability<a class="hash-link" href="#schemas-as-observability" title="Direct link to heading">‚Äã</a></h3><p>Calculating namespace-level statistics and splicing them into observability tools is the natural next step.</p><p>Stakeholder FAQ&#x27;s (long before actual analytics) commonly look like:</p><ul><li>&quot;I just implemented tracking. Is the data flowing?&quot;</li><li>&quot;When was some.event.v1 first deployed?&quot;</li><li>&quot;Is some.event.v1 still flowing?&quot;</li><li>&quot;Are we seeing any bad events after most recent deploy?&quot;</li><li>&quot;How much data are we processing for schema x.y.z?&quot;</li><li>&quot;I just changed some javascript. Am I still emitting one event or has it become ten?&quot;</li><li>&quot;What team should I go ask about a.b.c?&quot;</li><li>&quot;How does this event get generated again?&quot;</li></ul><p>When the name/namespace of a schema is present with each payload, and payloads are shipped to tools like Datadog, <strong>people can self-service answers to these questions.</strong></p><p>When the name/namespace of a schema is present with each payload, and the payloads are loaded into Snowflake, <strong>people can self-service answers to these questions.</strong></p><p>Self-service, low-cognitive-load systems minimize friction for everyone.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="schemas-power-compliance-oriented-requirements">Schemas power compliance-oriented requirements<a class="hash-link" href="#schemas-power-compliance-oriented-requirements" title="Direct link to heading">‚Äã</a></h3><p>(Actually) adhering to data privacy-oriented regulation requires a rethink of pretty much all data processing systems. The place to tokenize, redact, or hash personal information is not at the end of the data pipeline. It is at the start. Otherwise you&#x27;ll have sensitive data lying all over S3 in cleartext or flying through Kafka with no auth, and zero clue how to actually find or mitigate it.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="schemas-are-the-foundation-of-higher-order-data-models">Schemas are the foundation of higher-order data models<a class="hash-link" href="#schemas-are-the-foundation-of-higher-order-data-models" title="Direct link to heading">‚Äã</a></h3><p>It is pretty easy to turn a schema into a <a href="https://docs.getdbt.com/docs/building-a-dbt-project/using-sources" target="_blank" rel="noopener noreferrer">dbt source</a> so analytics engineers can reliably build upon a well-defined, trustworthy foundation.</p><p>If the foundation is not strong the analytics engineering team will spend all their time building &quot;layer 1 base models&quot; to santize inputs. In non-professional settings this would be called <a href="https://www.youtube.com/watch?v=VoP1E9J4jpg" target="_blank" rel="noopener noreferrer">Whack A Mole</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="schemas-are-the-foundation-of-data-products">Schemas are the foundation of data products<a class="hash-link" href="#schemas-are-the-foundation-of-data-products" title="Direct link to heading">‚Äã</a></h3><p>Similar to data modeling benefits, schemas allow data products to be built on a solid foundation. But there&#x27;s more that can be done on top of that foundation!</p><p>Automatically-generated endpoints, GraphQL queries, and API docs? Can do. Tools like <a href="https://quicktype.io/" target="_blank" rel="noopener noreferrer">Quicktype</a>, <a href="https://transform.tools/" target="_blank" rel="noopener noreferrer">Transform</a>, and <a href="https://www.apollographql.com/" target="_blank" rel="noopener noreferrer">Apollo</a> immediately come to mind. As does a blog post from the folks at <a href="https://wundergraph.com/blog/build_json_apis_with_json_schema_by_writing_graphql_operations_against_any_datasource_like_graphql_rest_apollo_federation_postgresql_mysql" target="_blank" rel="noopener noreferrer">Wundergraph</a>.</p><p>&quot;Schemas at the center&quot; is a pattern engineers are already comfortable with. <a href="https://www.openapis.org/" target="_blank" rel="noopener noreferrer">OpenAPI</a> is simply a declarative schema between API&#x27;s&lt;-&gt;frontends after all.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-contract-powered-workflow">The Contract-Powered Workflow<a class="hash-link" href="#the-contract-powered-workflow" title="Direct link to heading">‚Äã</a></h2><p>This is the workflow I&#x27;ve settled on after years of flipping levers and seeing what works (and what doesn&#x27;t). Mandates don&#x27;t work. Making analytics teams happy at the expense of poor application code going into production doesn&#x27;t work. Knowing instrumentation is bad only after it is deployed works-ish, but just barely. Would not recommend.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="draft-iterate-on-and-deploy-a-schema">Draft, iterate on, and deploy a schema.<a class="hash-link" href="#draft-iterate-on-and-deploy-a-schema" title="Direct link to heading">‚Äã</a></h3><p>The neat thing about schema-first workflows is <strong>non-engineer stakeholders can write the first draft</strong>. You don&#x27;t have to be a Typescript guru to get the process going, though engineering counterparts will need to be involved eventually.</p><p>The more work that can be front-loaded to non-engineers the better. Everyone&#x27;s time is valuable and schemas allow everyone to proactively contribute to the process. It sucks when useful contributions are discarded because they are &quot;not in a usable format&quot; (cough, Gdocs). Schemas are usable formats.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="bring-tracking-libraries-and-systems-up-to-parity">Bring tracking libraries and systems up to parity.<a class="hash-link" href="#bring-tracking-libraries-and-systems-up-to-parity" title="Direct link to heading">‚Äã</a></h3><p>The second a new schema or updated version has been published, automation kicks in and (at minimum):</p><ul><li>Builds and deploys new tracking SDK&#x27;s for engineering teams</li><li>Pushes schema metadata ‚àÜ to data discovery tools</li><li>Ensures infrastructure dependencies (Kafka topics, database tables, etc)</li><li>Pushes the schema to the appropriate place for pipeline-level validation</li><li>Creates dbt sources for the analytics engineers</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="implement-tracking">Implement tracking.<a class="hash-link" href="#implement-tracking" title="Direct link to heading">‚Äã</a></h3><p>Once systems are ready to accept the new instrumentation, engineers implement it into a codebase. It doesn&#x27;t matter if this is frontend code, backend code, cli&#x27;s, infrastructure tooling, etc - the process is the same.</p><p>Getting dependencies squared away takes a matter of seconds. By the time engineers are ready to implement the new tracking, the entire system is ready to go.</p><p>A question I&#x27;ve heard over and over from engineers is &quot;how do I know these payloads are making it to where they need to be?&quot; This question is best answered with &quot;go check Datadog/Graylog/Whatever&quot;. And followed up with, &quot;or you could also go check Snowflake for a table of the same name&quot;.</p><p>The faster engineers have feedback the better.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="deploy">Deploy.<a class="hash-link" href="#deploy" title="Direct link to heading">‚Äã</a></h3><p>And lastly - making tracking part of the codebase. A huge pain point of analytics-oriented instrumentation is the fact it&#x27;s often identified as &quot;bad&quot; after being pushed into prod. This is not awesome, and it greatly contributes to the upstream &quot;we&#x27;ll just throw arbitrary json down the line&quot; concensus. Everyone knows this is not ideal, but it&#x27;s definitely better than rolling back every-other deploy due to analytics bugs.</p><p>With contract-powered workflows the following prereqs are taken care of <em>before</em> instrumentation rolls out, not after:</p><ul><li>Implementers and stakeholders talk to each other using shared verbiage.</li><li>Versioned, language-specific data structures are generated like all other code dependencies.</li><li>Metadata is pushed to discovery tools.</li><li>The pipeline is primed to accept incoming payloads and mark them as &quot;good&quot; or &quot;bad&quot;.</li><li>Observability tools are ready to go for instantaneous feedback in development and production.</li><li>Downstream analytics/modeling entrypoints (like dbt sources) are in place and can be immediately used.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-schema-powered-future">The Schema-Powered Future<a class="hash-link" href="#the-schema-powered-future" title="Direct link to heading">‚Äã</a></h2><p>If it&#x27;s not obvious by now, schemas are <strong>awesome</strong>.</p><p>These workflows have significantly improved my work life, I know they&#x27;ve improved my colleagues&#x27;, and it&#x27;s probably just a matter of time before they improve yours too.</p><p>The fun part is it feels like this ecosystem is just getting started, and there are <strong>so</strong> many additional implications for the better. It&#x27;s not a new or original concept by any means. But as data management capabililities at Non-Google companies progress, it will be a consistent solution for consistent pain.</p><p><strong>Some other reading if you want to dive in:</strong></p><ul><li><a href="https://slack.engineering/data-wrangling-at-slack/" target="_blank" rel="noopener noreferrer">Data Wrangling at Slack</a></li><li><a href="https://www.slideshare.net/alexismidon/jitney-kafka-at-airbnb" target="_blank" rel="noopener noreferrer">Jitney at AirBnb</a></li><li><a href="https://engineering.linkedin.com/blog/2020/pegasus-data-language" target="_blank" rel="noopener noreferrer">Pegasus at LinkedIn</a></li><li><a href="https://1fykyq3mdn5r21tpna3wkdyi-wpengine.netdna-ssl.com/wp-content/uploads/2020/03/Schema-Integration-at-Uber-Scale-US2TS-2020-1.pdf" target="_blank" rel="noopener noreferrer">Dragon at Uber</a></li><li><a href="https://doordash.engineering/2022/08/02/building-scalable-real-time-event-processing-with-kafka-and-flink/" target="_blank" rel="noopener noreferrer">Building Scalable Real Time Event Processing with Kafka and Flink</a> at Doordash</li><li><a href="https://netflixtechblog.com/data-mesh-a-data-movement-and-processing-platform-netflix-1288bcab2873" target="_blank" rel="noopener noreferrer">Data Mesh at Netflix</a></li><li><a href="https://shopify.engineering/real-time-buyer-signal-data-pipeline-shopify-inbox" target="_blank" rel="noopener noreferrer">Building a Real-time Buyer Signal Data Pipeline for Shopify Inbox</a></li></ul><p><strong>You could also:</strong></p><ul><li>Tune in for <a href="https://coalesce.getdbt.com/agenda/getting-jiggy-with-jsonschema-the-power-of-contracts-for-building-data-systems" target="_blank" rel="noopener noreferrer">Getting jiggy with JSON Schema at dbt Coalesce</a> or <a href="https://twitter.com/emilyhawkins__" target="_blank" rel="noopener noreferrer">join the conversation</a> on <a href="https://twitter.com/aerialfly" target="_blank" rel="noopener noreferrer">Twitter</a>.</li></ul><p>As closing context from a Shopify perspective, 9800+ schemas and 1800+ contributors (many of whom are not engineers) is a huge feat. As is deploying hundreds of schema-generated instrumentation blocks to thousands of robots around the world. The model works.</p><p>Here&#x27;s to our schema-powered future ü•Ç.</p></div><footer class="row docusaurus-mt-lg blogPostFooterDetailsFull_mRVl"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/data-platform">data platform</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/schemas">schemas</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/interfaces">interfaces</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/data-contracts-or-whatever">data contracts or whatever</a></li></ul></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--next" href="/blog/make-it-easy"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Make It Easy</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#components-of-a-good-data-platform" class="table-of-contents__link toc-highlight">Components of a Good Data Platform</a><ul><li><a href="#instrumentation-and-integration" class="table-of-contents__link toc-highlight">Instrumentation and Integration</a></li><li><a href="#the-pipeline" class="table-of-contents__link toc-highlight">The pipeline</a></li><li><a href="#storage-and-access" class="table-of-contents__link toc-highlight">Storage and access</a></li><li><a href="#data-discovery" class="table-of-contents__link toc-highlight">Data Discovery</a></li><li><a href="#observability-monitoring-and-alerting" class="table-of-contents__link toc-highlight">Observability, Monitoring, and Alerting</a></li></ul></li><li><a href="#design-goals-of-a-good-data-platform" class="table-of-contents__link toc-highlight">Design Goals of a Good Data Platform</a><ul><li><a href="#comply-with-rules" class="table-of-contents__link toc-highlight">Comply with rules</a></li><li><a href="#minimize-bad-data" class="table-of-contents__link toc-highlight">Minimize bad data</a></li><li><a href="#maximize-knowledge-of-what-the-system-is-doing" class="table-of-contents__link toc-highlight">Maximize knowledge of what the system is doing</a></li><li><a href="#minimize-friction-for-all-parties-involved" class="table-of-contents__link toc-highlight">Minimize friction for all parties involved</a></li></ul></li><li><a href="#the-contract-powered-platform" class="table-of-contents__link toc-highlight">The Contract-Powered Platform</a><ul><li><a href="#schemas-empower-the-producer---consumer-relationship" class="table-of-contents__link toc-highlight">Schemas empower the &quot;producer&quot; &lt;-&gt; &quot;consumer&quot; relationship</a></li><li><a href="#schemas-are-data-discovery" class="table-of-contents__link toc-highlight">Schemas are data discovery</a></li><li><a href="#schemas-power-data-validation-in-transit" class="table-of-contents__link toc-highlight">Schemas power data validation in transit</a></li><li><a href="#schemas-help-stop-bad-instrumentation-from-being-implemented-in-the-first-place" class="table-of-contents__link toc-highlight">Schemas help stop bad instrumentation from being implemented in the first place</a></li><li><a href="#schemas-improve-code-quality" class="table-of-contents__link toc-highlight">Schemas improve code quality</a></li><li><a href="#schemas-power-automation" class="table-of-contents__link toc-highlight">Schemas power automation</a></li><li><a href="#schemas-as-observability" class="table-of-contents__link toc-highlight">Schemas as observability</a></li><li><a href="#schemas-power-compliance-oriented-requirements" class="table-of-contents__link toc-highlight">Schemas power compliance-oriented requirements</a></li><li><a href="#schemas-are-the-foundation-of-higher-order-data-models" class="table-of-contents__link toc-highlight">Schemas are the foundation of higher-order data models</a></li><li><a href="#schemas-are-the-foundation-of-data-products" class="table-of-contents__link toc-highlight">Schemas are the foundation of data products</a></li></ul></li><li><a href="#the-contract-powered-workflow" class="table-of-contents__link toc-highlight">The Contract-Powered Workflow</a><ul><li><a href="#draft-iterate-on-and-deploy-a-schema" class="table-of-contents__link toc-highlight">Draft, iterate on, and deploy a schema.</a></li><li><a href="#bring-tracking-libraries-and-systems-up-to-parity" class="table-of-contents__link toc-highlight">Bring tracking libraries and systems up to parity.</a></li><li><a href="#implement-tracking" class="table-of-contents__link toc-highlight">Implement tracking.</a></li><li><a href="#deploy" class="table-of-contents__link toc-highlight">Deploy.</a></li></ul></li><li><a href="#the-schema-powered-future" class="table-of-contents__link toc-highlight">The Schema-Powered Future</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Sources</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/sources/snowplow-analytics">Snowplow Analytics</a></li><li class="footer__item"><a class="footer__link-item" href="/sources/webhook">Webhooks</a></li><li class="footer__item"><a class="footer__link-item" href="/sources/self-describing-json">Self-Describing JSON</a></li><li class="footer__item"><a class="footer__link-item" href="/sources/pixel">Pixel</a></li><li class="footer__item"><a class="footer__link-item" href="/sources/cloudevents">CloudEvents</a></li></ul></div><div class="col footer__col"><div class="footer__title">Integrations</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/integrations/google-pub-sub">Google Pub/Sub</a></li><li class="footer__item"><a class="footer__link-item" href="/integrations/aws-kinesis-firehose">AWS Kinesis Firehose</a></li><li class="footer__item"><a class="footer__link-item" href="/integrations/kafka">Kafka</a></li><li class="footer__item"><a class="footer__link-item" href="/integrations/redpanda">Redpanda</a></li><li class="footer__item"><a class="footer__link-item" href="/integrations/postgres">Postgres</a></li></ul></div><div class="col footer__col"><div class="footer__title">Buz</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/">Docs</a></li><li class="footer__item"><a href="https://github.com/silverton-io/buz/" target="_blank" rel="noopener noreferrer" class="footer__link-item">On GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2022 Silverton Data, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.60654a09.js"></script>
<script src="/assets/js/main.6b317ddd.js"></script>
</body>
</html>